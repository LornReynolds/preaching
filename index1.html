<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Go Preach!</title>
  <style>


    

    #map {
      height: 100vh;
      width: 100%;
    }

  h1{text-align: center;}
  h2{text-align: center;}
  h3{text-align: center;}
  h4{text-align: center;}
   p{text-align: center;}
   input{text-align: center;}


    /* Optional: Makes the sample page fill the window. */
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
    }

  </style>


</head>
<body>
  

  <h1 align:center>Go Preach!</h1>
  <h2>
    Red=No Answer / Green=Preached / Blue=Contact
 </h2>
 

<div class="container" align="center">
    <input type="radio" name="color" id="red" value="check_red.png" checked/>Red</br>
    <input type="radio" name="color" id="green" value="check_green.png"/>Green</br>
    <input type="radio" name="color" id="blue" value="check_blue.png"/>Blue</br>
    <p id="result">:</p>
</div>


<p>Tap screen once to drop markers</p>
<p>Tap once on a marker to display/hide address | Hold and drag markers to move location</p>
 
<script>
  let radioBtns = document.querySelectorAll ("input[name='color']");
  let result = document.getElementById("result");

    let findSelected = () => {
      var selected = document.querySelector("input[name='color']:checked").value;
      result.textContent = `${selected}`;
      console.log('selected: ', selected);
      window.selected = selected;
    }

    
    radioBtns.forEach(radioBtn => {
      radioBtn.addEventListener("change", findSelected);
    });
    
    var choice = result.textContent;
    findSelected();    
</script>

<script>
console.log('window: ', selected);
</script>

  <script>
    /* Global Variables */
    var selected;
    var choice;
    var map;
    var firebase;
    var markers = [];
    var markerUrl;
    var infoWindows = [];
    var geocoder;
    var color;
    var apiKey;
  </script>


  <div id="map"></div>

  <script src="config.js"></script>
  <script src="script.js"></script>
  <script defer
  src='https://maps.googleapis.com/maps/api/js?key=AIzaSyCxz1QK1tKyHAbz7VmW7o7atBNo-Q5XjNg&callback=initMap'>
  </script>    
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>


  <script>

    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: apiKey,
  // apiKey: "AIzaSyCxz1QK1tKyHAbz7VmW7o7atBNo-Q5XjNg",
  authDomain: "preaching-map-mmz.firebaseapp.com",
  databaseURL: "https://preaching-map-mmz-default-rtdb.firebaseio.com",
  projectId: "preaching-map-mmz",
  storageBucket: "preaching-map-mmz.appspot.com",
  messagingSenderId: "652763143103",
  appId: "1:652763143103:web:66265a281de2558130df0a",
  measurementId: "G-7EGHMNXZ2L"
};

firebase.initializeApp(firebaseConfig);
const database = firebase.database();

// Load markers from the Firebase database
function loadMarkersFromDatabase() {
  const markersRef = database.ref('markers');

  markersRef.on('child_added', function(snapshot) {
      const markerData = snapshot.val();
      // console.log('snapshot: ',snapshot.val());
      const position = new google.maps.LatLng(markerData.position.lat, markerData.position.lng);


      const marker = new google.maps.Marker({
        position: position,
        map: map,
        icon: {
            url: selected,
            scaledSize: new google.maps.Size(20, 20)
        }
    });

    marker.id = snapshot.key;
    markers.push(marker);
});
}

// Wait for the markers to be loaded before initializing the map
loadMarkersFromDatabase();

// Call a function to listen for changes in the database
//listenForMarkerUpdates();

// Initialize the map
initMap();


  </script>
  
</body>

</html>